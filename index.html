<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Course Index</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    /* --------- ACTIVE HIGHLIGHTS --------- */
    .active-page {
      @apply bg-blue-100 text-blue-800 font-semibold rounded;
    }
    .active-summary {
      @apply text-blue-600 font-semibold; /* course / section summary highlight */
    }
    /* custom scrollbar for sidebar */
    #sidebar::-webkit-scrollbar {
      width: 6px;
    }
    #sidebar::-webkit-scrollbar-track {
      background: transparent;
    }
    #sidebar::-webkit-scrollbar-thumb {
      background: rgb(199 210 254); /* indigo-200 */
      border-radius: 3px;
    }
  </style>
</head>
<body class="h-screen flex overflow-hidden bg-gray-50 font-sans antialiased">
  <!-- Sidebar (left) -->
  <aside id="sidebar" class="w-72 bg-white border-r overflow-y-auto">
    <!-- brand / search -->
    <div class="sticky top-0 z-10 bg-gradient-to-r from-blue-600 to-indigo-700 text-white p-4 shadow">
      <h1 class="text-lg font-bold tracking-wide">Course Library</h1>
    </div>
    <div class="p-4" id="sidebarContent"></div>
  </aside>

  <!-- Main content area -->
  <div class="flex-1 flex flex-col">
    <!-- Top bar -->
    <header class="sticky top-0 z-10 bg-white/70 backdrop-blur border-b px-6 py-3 flex items-center justify-between">
      <h2 id="pageTitle" class="text-lg font-medium text-gray-800 truncate">Select a lesson from the sidebar</h2>
    </header>

    <!-- iframe -->
    <iframe id="contentFrame" title="Course Content" class="flex-1 w-full bg-white"></iframe>

    <!-- Navigation bar -->
    <div class="p-4 bg-gray-100 border-t flex justify-between gap-2">
      <button id="prevBtn" class="px-4 py-2 rounded border bg-white shadow-sm disabled:opacity-40 disabled:cursor-not-allowed">‚¨ÖÔ∏è Previous</button>
      <button id="nextBtn" class="px-4 py-2 rounded border bg-white shadow-sm disabled:opacity-40 disabled:cursor-not-allowed">Next ‚û°Ô∏è</button>
    </div>
  </div>

  <script>
    // ---------- DATA -------------------------------------------
    const courses = [
      {
        title: "AI Fundamentals",
        sections: [
          {
            title: "Getting Started",
            pages: [
              { title: "üòÉ Welcome", url: "modules/AI/iframes/welcome.html" },
              { title: "üìö All About Your Course", url: "modules/AI/iframes/All_About_Your_Course.html" },
              { title: "‚ö°Ô∏è A snapshot in time", url: "modlues/AI/iframes/A_snapshot_in_time.html" },
            ],
          },
          {
            title: "Section 1: What is AI?",
            pages: [
              { title: "Section 1 Introduction", url: "modules/AI/iframes/Section_1.html" },
              { title: "AI in everyday life", url: "modules/AI/iframes/AI_in_everday_life.html" },
              { title: "What is intelligence?", url: "modules/AI/iframes/What_is_intelligence.html" },
              { title: "Activity: What is intelligence?", url: "modules/AI/iframes/Activity_What_is_intelligence.html" },
              { title: "Activity: A scale of intelligence", url: "modules/AI/iframes/Scale_of_intelligence.html" },
              { title: "A brief history lesson", url: "modules/AI/iframes/Brief_history_lesson.html" },
              { title: "The AI effect", url: "modules/AI/iframes/The_AI_effect.html" },
            ],
          },
          {
            title: "Section 2: Types of AI",
            pages: [
              { title: "Section 2 Introduction", url: "#" },
              { title: "What are algorithms?", url: "#" },
              { title: "Classical (symbolic) AIs", url: "#" },
              { title: "Taking inspiration from nature", url: "#" },
              { title: "Neural networks fundamentals", url: "#" },
              { title: "The main types of neural networks", url: "#" },
              { title: "Neural Networks Drag and Drop", url: "#" },
              { title: "Machine learning", url: "#" },
              { title: "Section 2 Quiz", url: "#" },
              { title: "Section 2 Reflection", url: "#" },
            ],
          },
          {
            title: "Section 3: Conversational AI",
            pages: [
              { title: "Section 3 Introduction", url: "#" },
              { title: "Large language models (LLMs)", url: "#" },
              { title: "The big three of '23", url: "#" },
              { title: "Hallucinations", url: "#" },
              { title: "Connected conversational AIs", url: "#" },
              { title: "The bootstrap problem", url: "#" },
              { title: "Section 3 Quiz", url: "#" },
              { title: "Section 3 Reflection", url: "#" },
            ],
          },
          {
            title: "Section 4: Prompt Engineering",
            pages: [
              { title: "Section 4 Introduction", url: "#" },
              { title: "Detail and refinement", url: "#" },
              { title: "Simulation and simulacra", url: "#" },
              { title: "Activity: Simulation and simulacra", url: "#" },
              { title: "Who, when, with, what, why?", url: "#" },
              { title: "Prompts for learning", url: "#" },
              { title: "Image generation", url: "#" },
              { title: "What else can an AI generate?", url: "#" },
              { title: "Section 4 Quiz", url: "#" },
              { title: "Section 4 Reflection", url: "#" },
            ],
          },
          {
            title: "Section 5: Society and AI",
            pages: [
              { title: "Section 5 Introduction", url: "#" },
              { title: "Inclusion and accessibility", url: "#" },
              { title: "Healthcare, finance and cybersecurity", url: "#" },
              { title: "Bias", url: "#" },
              { title: "Ethics and Alignment", url: "#" },
              { title: "Fake news and deepfakes", url: "#" },
              { title: "Safety and responsibility", url: "#" },
              { title: "Section 5 Quiz", url: "#" },
              { title: "Section 5 Reflection", url: "#" },
            ],
          },
          {
            title: "Section 6: The Future of AI",
            pages: [
              { title: "Section 6 Introduction", url: "#" },
              { title: "Where are we on the sigmoid curve?", url: "#" },
              { title: "Jobs and intellectual property", url: "#" },
              { title: "Artificial general intelligence (AGI)", url: "#" },
              { title: "Existential threat!?", url: "#" },
              { title: "It all comes down to this...", url: "#" },
              { title: "Section 6 Quiz", url: "#" },
              { title: "Section 6 Reflection", url: "#" },
            ],
          },
        ],
      },
      { title: "Applying for University", sections: [] },
      { title: "Coding Games with Python", sections: [] },
      { title: "Creative Problem Solving", sections: [] },
      { title: "CV Writing", sections: [] },
      { title: "Entrepreneurship", sections: [] },
      { title: "Job Interview Skills", sections: [] },
      { title: "Making an Impact", sections: [] },
      { title: "Personal Statement Writing", sections: [] },
      { title: "Preparing for BMAT", sections: [] },
      { title: "Preparing for LNAT", sections: [] },
      { title: "Preparing for TSA", sections: [] },
      { title: "Public Speaking", sections: [] },
      { title: "Resilience", sections: [] },
      { title: "Study Skills", sections: [] },
      { title: "University Interview Skills", sections: [] },
      { title: "Verbal Communication", sections: [] },
      { title: "Writing Skills", sections: [] },
    ];

    // ---------- STATE ------------------------------------------
    let currentCourseIdx = null;
    let currentPageIdx = null;
    let flatPages = [];

    // ---------- DOM BUILDING -----------------------------------
    const sidebarContent = document.getElementById("sidebarContent");

    function buildSidebar() {
      courses.forEach((course, cIdx) => {
        const courseDetails = document.createElement("details");
        courseDetails.className = "mb-2 group";

        const courseSummary = document.createElement("summary");
        courseSummary.className = "font-semibold cursor-pointer flex justify-between items-center text-gray-800 hover:text-blue-600";
        courseSummary.innerHTML = `${course.title} <span class="transition-transform group-open:rotate-180">‚ñæ</span>`;
        courseDetails.appendChild(courseSummary);

        course.sections.forEach((section, sIdx) => {
          const sectionDetails = document.createElement("details");
          sectionDetails.className = "ml-4 mt-1 mb-1 group";

          const sectionSummary = document.createElement("summary");
          sectionSummary.className = "cursor-pointer flex justify-between items-center text-sm text-gray-600 hover:text-blue-600";
          sectionSummary.innerHTML = `${section.title} <span class="transition-transform group-open:rotate-180">‚ñæ</span>`;
          sectionDetails.appendChild(sectionSummary);

          const ul = document.createElement("ul");
          ul.className = "list-disc ml-6 mt-1 space-y-1 text-sm";

          section.pages.forEach((page, pIdx) => {
            const li = document.createElement("li");
            const btn = document.createElement("button");
            btn.textContent = page.title;
            btn.className = "text-left hover:underline text-gray-700 w-full"
            btn.addEventListener("click", () => selectPage(cIdx, getFlatPageIndex(course, sIdx, pIdx)));
            li.appendChild(btn);
            ul.appendChild(li);
          });
          sectionDetails.appendChild(ul);
          courseDetails.appendChild(sectionDetails);
        });

        sidebarContent.appendChild(courseDetails);
      });
    }

    function getFlatPageIndex(course, sectionIdx, pageIdx) {
      let index = 0;
      course.sections.forEach((sec, s) => {
        if (s < sectionIdx) index += sec.pages.length;
      });
      return index + pageIdx;
    }

    // ---------- PAGE SELECTION & NAV ----------------------------
    const frame = document.getElementById("contentFrame");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const pageTitle = document.getElementById("pageTitle");

    function selectPage(courseIdx, pageIdx) {
      if (courseIdx !== currentCourseIdx) {
        currentCourseIdx = courseIdx;
        flatPages = courses[courseIdx].sections.flatMap(sec => sec.pages);
      }
      currentPageIdx = pageIdx;
      const page = flatPages[pageIdx];
      frame.src = page.url;
      pageTitle.textContent = page.title;
      updateNav();
      highlightActive(page.title);
    }

    function updateNav() {
      prevBtn.disabled = currentPageIdx <= 0;
      nextBtn.disabled = currentPageIdx >= flatPages.length - 1;
    }

    function highlightActive(title) {
      // remove previous highlights and summary highlights
      document.querySelectorAll(".active-page").forEach(el => el.classList.remove("active-page"));
      document.querySelectorAll(".active-summary").forEach(el => el.classList.remove("active-summary"));

      // highlight button
      const btn = [...sidebarContent.querySelectorAll("button")].find(b => b.textContent === title);
      if (btn) btn.classList.add("active-page");

      // also highlight its parent summaries
      let el = btn.parentElement;
      while (el && el.tagName !== "ASIDE") {
        if (el.tagName === "SUMMARY") el.classList.add("active-summary");
        el = el.parentElement;
      }
    }

    prevBtn.addEventListener("click", () => {
      if (currentPageIdx > 0) selectPage(currentCourseIdx, currentPageIdx - 1);
    });

    nextBtn.addEventListener("click", () => {
      if (currentPageIdx < flatPages.length - 1) selectPage(currentCourseIdx, currentPageIdx + 1);
    });

    // INIT ----------------------------------------------------------------
    buildSidebar();
    // auto-open first course for better UX
    const firstCourseDetails = sidebarContent.querySelector("details");
    firstCourseDetails.setAttribute("open", "");
  </script>
</body>
</html>